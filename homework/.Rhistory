population_growth = pop_2007 - pop_1952) %>%
arrange(desc(gdp_growth))
gapminder_p_combined
gapminder_p_combined %>%
ggplot(aes(x = log10(population_growth), y = gdp_growth)) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 5 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_p_gdp <- gapminder_p %>%
select(-"pop") %>%
group_by(country) %>%
pivot_wider(names_from = year,
values_from = gdpPercap,
names_prefix = "gdp_")
gapminder_p_pop <- gapminder_p %>%
select(-"gdpPercap") %>% #very important
group_by(country) %>%
pivot_wider(names_from = year,
values_from = pop,
names_prefix = "pop_")
gapminder_w <- gapminder %>%
arrange(desc(gdpPercap)) %>%
head(100)
gapminder_p <- gapminder %>%
filter(year %in% c(1952, 2007)) %>%
filter(country %in% gapminder_w$country) %>%
select(year, gdpPercap, pop, country)
head(gapminder_p, 100)
gapminder_p_gdp <- gapminder_p %>%
select(-"pop") %>%
group_by(country) %>%
pivot_wider(names_from = year,
values_from = gdpPercap,
names_prefix = "gdp_")
gapminder_p_pop <- gapminder_p %>%
select(-"gdpPercap") %>% #very important
group_by(country) %>%
pivot_wider(names_from = year,
values_from = pop,
names_prefix = "pop_")
gapminder_p_combined <- bind_cols(gapminder_p_gdp, gapminder_p_pop) %>%
mutate(gdp_growth = gdp_2007 - gdp_1952,
population_growth = pop_2007 - pop_1952) %>%
arrange(desc(gdp_growth))
gapminder_p_combined
gapminder_p_combined %>%
ggplot(aes(x = log10(population_growth), y = gdp_growth)) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 5 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_p_combined %>%
ggplot(aes(x = log10(population_growth), y = gdp_growth)) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_p_combined %>%
ggplot(aes(x = log10(population_growth), y = |gdp_growth|)) +
gapminder_p_combined %>%
ggplot(aes(x = log10(population_growth), y = log10(gdp_growth)) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_p_combined %>%
ggplot(aes(x = log10(population_growth), y = log10(gdp_growth))) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_p_combined %>%
filter(population_growth > 0 & gdp_growth > 0) %>%  # Filter out rows with zero or negative values
ggplot(aes(x = log10(population_growth), y = log10(gdp_growth))) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_p_combined %>%
ggplot(aes(x = population_growth, y = gdp_growth)) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = population_growth, y = gdp_growth)) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = log10(population_growth), y = gdp_growth)) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_w <- gapminder %>%
arrange(desc(gdpPercap)) %>%
head(50)
gapminder_p <- gapminder %>%
filter(year %in% c(1952, 2007)) %>%
filter(country %in% gapminder_w$country) %>%
select(year, gdpPercap, pop, country)
head(gapminder_p, 50)
gapminder_p_gdp <- gapminder_p %>%
select(-"pop") %>%
group_by(country) %>%
pivot_wider(names_from = year,
values_from = gdpPercap,
names_prefix = "gdp_")
gapminder_p_pop <- gapminder_p %>%
select(-"gdpPercap") %>% #very important
group_by(country) %>%
pivot_wider(names_from = year,
values_from = pop,
names_prefix = "pop_")
gapminder_p_combined <- bind_cols(gapminder_p_gdp, gapminder_p_pop) %>%
mutate(gdp_growth = gdp_2007 - gdp_1952,
population_growth = pop_2007 - pop_1952) %>%
arrange(desc(gdp_growth))
gapminder_p_combined
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = log10(population_growth), y = gdp_growth)) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_w <- gapminder %>%
arrange(desc(gdpPercap)) %>%
head(25)
gapminder_p <- gapminder %>%
filter(year %in% c(1952, 2007)) %>%
filter(country %in% gapminder_w$country) %>%
select(year, gdpPercap, pop, country)
head(gapminder_p, 25)
gapminder_p_gdp <- gapminder_p %>%
select(-"pop") %>%
group_by(country) %>%
pivot_wider(names_from = year,
values_from = gdpPercap,
names_prefix = "gdp_")
gapminder_p_pop <- gapminder_p %>%
select(-"gdpPercap") %>% #very important
group_by(country) %>%
pivot_wider(names_from = year,
values_from = pop,
names_prefix = "pop_")
gapminder_p_combined <- bind_cols(gapminder_p_gdp, gapminder_p_pop) %>%
mutate(gdp_growth = gdp_2007 - gdp_1952,
population_growth = pop_2007 - pop_1952) %>%
arrange(desc(gdp_growth))
gapminder_p_combined
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = log10(population_growth), y = gdp_growth)) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = country...1, y = gdp_growth, fill = population_growth)) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_w <- gapminder %>%
arrange(desc(gdpPercap)) %>%
head(50)
gapminder_p <- gapminder %>%
filter(year %in% c(1952, 2007)) %>%
filter(country %in% gapminder_w$country) %>%
select(year, gdpPercap, pop, country)
head(gapminder_p, 50)
gapminder_p_gdp <- gapminder_p %>%
select(-"pop") %>%
group_by(country) %>%
pivot_wider(names_from = year,
values_from = gdpPercap,
names_prefix = "gdp_")
gapminder_p_pop <- gapminder_p %>%
select(-"gdpPercap") %>% #very important
group_by(country) %>%
pivot_wider(names_from = year,
values_from = pop,
names_prefix = "pop_")
gapminder_p_combined <- bind_cols(gapminder_p_gdp, gapminder_p_pop) %>%
mutate(gdp_growth = gdp_2007 - gdp_1952,
population_growth = pop_2007 - pop_1952) %>%
arrange(desc(gdp_growth))
gapminder_p_combined
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = country...1, y = gdp_growth, fill = population_growth)) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal()
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = country...1, y = gdp_growth, fill = population_growth)) +
geom_col() +
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal()
theme_linedraw()+
theme(plot.title=element_text(size = rel(1.75), hjus=0.5))+
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme_minimal(plot.title = element_text(size = rel(1.75), hjust = 0.5))
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = country...1, y = gdp_growth, fill = population_growth)) +
geom_col() +
theme_minimal()+
theme(plot.title=element_text(size = rel(1.75), hjus=0.5))+
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme(plot.title = element_text(size = rel(1.75), hjust = 0.5))
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = country...1, y = gdp_growth, fill = population_growth)) +
geom_col() +
theme_minimal()+
theme(plot.title=element_text(size = rel(1.75), hjus=0.5))+
labs(x = "Population Growth (1952-2007)",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 100 Countries with the Biggest Population Growth") +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = country...1, y = gdp_growth, fill = population_growth)) +
geom_col() +
theme_minimal()+
theme(plot.title=element_text(size = rel(1.75), hjus=0.5))+
labs(x = "Population Growth (1952-2007) and its relation to the GDP growth",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Top 50 Countries with the Biggest Population Growth") +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = country...1, y = gdp_growth, fill = population_growth)) +
geom_col() +
theme_minimal()+
theme(plot.title=element_text(size = rel(1.75), hjus=0.5))+
labs(x = "Countries",
y = "GDP Growth (1952-2007)",
color = "Country",
title = "Population Growth (1952-2007) and Its Relation To the GDP Growth") +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = country...1, y = gdp_growth, fill = population_growth)) +
geom_col() +
theme_minimal()+
theme(plot.title=element_text(size = rel(1.75), hjus=0.5))+
labs(x = "Countries",
y = "GDP Growth (1952-2007)",
color = "Top 50 Countries with High Poplation Growth",
title = "Population GDP Growth relation") +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = country...1, y = gdp_growth, fill = population_growth)) +
geom_col() +
theme_minimal()+
theme(plot.title=element_text(size = rel(1.75), hjus=0.5))+
labs(x = "Top 50 Countries with High Poplation Growth",
y = "GDP Growth (1952-2007)",
title = "Population GDP Growth relation") +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = country...1, y = gdp_growth, fill = population_growth)) +
geom_col() +
theme_minimal()+
theme(plot.title=element_text(size = rel(1.75), hjus=0.5))+
labs(x = "Top Countries with High Poplation Growth",
y = "GDP Growth (1952-2007)",
title = "Population GDP Growth relation") +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
gapminder_p_combined %>%
filter(country...1 != "Kuwait") %>%
ggplot(aes(x = country...1, y = gdp_growth, fill = population_growth)) +
geom_col() +
theme_minimal()+
theme(plot.title=element_text(size = rel(1.75), hjus=0.5))+
labs(x = "Top High Poplation Growth Countries",
y = "GDP Growth (1952-2007)",
title = "Population GDP Growth relation") +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
ggplot(data=iris, #specify the data
mapping=aes(x=Species, y=Petal.Length)) #map the aesthetics
ggplot(data=iris, #specify the data
mapping=aes(x=Species, y=Petal.Length))+ #map the aesthetics
geom_boxplot() #add the plot type
library(tidyverse)
library(janitor)
library(palmerpenguins)
options(scipen=999) #cancels the use of scientific notation for the session
homerange <-
read_csv("data/Tamburelloetal_HomeRangeDatabase.csv", na = c("", "NA", "\\"))
p <- homerange %>%
ggplot(aes(x= log10.mass, y= log10.hra))
p + geom_point(size=1.25)
p + geom_point(aes(color=thermoregulation), size = 1.5) #for scaterplots color is the same as fill for the boxplots
p + geom_point(aes(color=thermoregulation, shape=thermoregulation), size = 1.5)
homerange %>% count(taxon, sort=T)
homerange %>%
ggplot(aes(x=taxon))+
geom_bar()+
coord_flip()
homerange %>%
ggplot(aes(x=taxon, fill= trophic.guild))+
geom_bar()+
coord_flip()+
labs(tittle= "Observations by Taxon",
x="Taxonomic Group")
homerange %>%
ggplot(aes(x=taxon, fill= trophic.guild))+
geom_bar(position="dodge")+
coord_flip()+
labs(tittle= "Observations by Taxon",
x="Taxonomic Group")
homerange %>%
mutate(hra_category= case_when(log10.hra<3.65 ~ "1st quartile",
log10.hra>3.65 & log10.hra<=4.59 ~ "2st quartile",
log10.hra>4.59 & log10.hra<=6.03 ~ "3st quartile",
log10.hra>6.03 ~ "4st quartile")) %>%
filter(hra_category == "2st quartile") %>%
ggplot(aes(x=class, y=log10.mass, fill=class))+
geom_boxplot()
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
options(scipen=999) #cancels the use of scientific notation for the session
deserts <- read_csv("data/surveys_complete.csv")
homerange <- read_csv("data/Tamburelloetal_HomeRangeDatabase.csv", na = c("", "NA", "\\"))
homerange %>%
filter(log10.mass != "NA") %>%
ggplot(aes(x=taxon, y=log10.mass))+
geom_boxplot()+
labs(title="Mass Range Among Taxa",
y= "Mass",
x="Taxa")+
theme(axis.text.x=element_text(angle = 60, hjust= 1),
plot.title = element_text(size = rel(1.5), hjust = 0.5))
homerange %>%
filter(!is.na(log10.mass)) %>%
ggplot(aes(x = taxon, y = log10.mass, fill = class)) +
geom_boxplot() +
labs(title = "Mass Range Among Taxa",
y = "Mass",
x = "Taxa") +
theme(axis.text.x = element_text(angle = 60, hjust = 1),
plot.title = element_text(size = rel(1.5), hjust = 0.5))
homerange %>%
filter(!is.na(log10.mass)) %>%
ggplot(aes(x = class, y = log10.mass, group = taxon)) + #like fill, but with no color
geom_boxplot() +
labs(title = "Mass Range Among Taxa",
y = "Mass",
x = "Taxa") +
theme(axis.text.x = element_text(angle = 60, hjust = 1),
plot.title = element_text(size = rel(1.5), hjust = 0.5))
homerange %>%
filter(!is.na(log10.mass)) %>%
ggplot(aes(x = class, y = log10.mass, fill = taxon)) +
geom_boxplot() +
labs(title = "Mass Range Among Taxa",
y = "Mass",
x = "Taxa") +
theme(axis.text.x = element_text(angle = 60, hjust = 1),
plot.title = element_text(size = rel(1.5), hjust = 0.5))
deserts %>%
filter(species_id %in% c("DS", "DM")) %>%
mutate(year==as.factor(year)) %>%
group_by(year, species_id) %>%
summarise(n=n(), .groups='keep')%>%
pivot_wider(names_from = species_id, values_from = n)
deserts %>%
filter(species_id == "DM" | species_id == "DS") %>%
mutate(year = as.factor(year)) %>%
group_by(year, species_id) %>%
summarise(n = n(), .groups = 'keep') %>%
ggplot(aes(x = year, y = n, group = species_id, color = species_id)) +
geom_line() +
geom_point(shape = 2) +
theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
labs(title = "Number of Species DM and DS", x = "Year", y = "n")
homerange %>%
ggplot(aes(x = log10.mass)) +
geom_histogram(bins = 20)+ #we can adjust the number of bins with the bins argument
labs(title = "Distribution of Body Mass")
#grDevices::colors()
homerange %>%
ggplot(aes(x = log10.mass)) +
geom_histogram(color = "black", fill = "lavenderblush2", bins=10)+
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x = log10.mass)) + #only x needed
geom_density(fill="deepskyblue4", alpha  =0.4, color = "black")+ #alpha is the transparency, probability distribution
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x=log10.mass)) +
geom_histogram(aes(y = after_stat(density)), fill = "deepskyblue4", alpha = 0.4, color = "black")+
geom_density(color = "red")+
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x = log10.hra)) +
geom_histogram(color = "black", fill = "lavenderblush2", bins=10)+
labs(title = "Distribution of hra")
homerange %>%
ggplot(aes(x = log10.hra)) +
geom_density(fill="deepskyblue4", alpha  =0.4, color = "black")+
labs(title = "Distribution of hra")
homerange %>%
ggplot(aes(x=log10.hra)) +
geom_histogram(aes(y = after_stat(density)), fill = "deepskyblue4", alpha = 0.4, color = "black")+
geom_density(color = "red")+
labs(title = "Distribution of hra")
glimpse(homerange)
summary(homerange$log10.mass)
homerange %>%
mutate(mass_category= case_when(log10.mass<=1.75 ~ "small",
log10.mass>1.75 & log10.mass<=2.75 ~ "medium",
log10.mass>2.75 ~ "large"))
homerange %>%
mutate(mass_category= case_when(log10.mass<=1.75 ~ "small",
log10.mass>1.75 & log10.mass<=2.75 ~ "medium",
log10.mass>2.75 ~ "large")) %>%
ggplot(aes(x=mass_category, fill=trophic.guild))+
geom_bar(position = "dodge") #side by side
#install.packages("gtools")
library(gtools)
quartiles <-quantcut(homerange$log10.hra)
table(quartiles)
homerange %>%
mutate(hra_category= case_when(log10.hra<3.65 ~ "1st quartile",
log10.hra>3.65 & log10.hra<=4.59 ~ "2st quartile",
log10.hra>4.59 & log10.hra<=6.03 ~ "3st quartile",
log10.hra>6.03 ~ "4st quartile"))
homerange %>%
mutate(hra_category= case_when(log10.hra<3.65 ~ "1st quartile",
log10.hra>3.65 & log10.hra<=4.59 ~ "2st quartile",
log10.hra>4.59 & log10.hra<=6.03 ~ "3st quartile",
log10.hra>6.03 ~ "4st quartile")) %>%
ggplot(aes(x=hra_category, fill=class))+
geom_bar(position = "dodge", alpha=0.6, color="black")
homerange %>%
mutate(hra_category= case_when(log10.hra<3.65 ~ "1st quartile",
log10.hra>3.65 & log10.hra<=4.59 ~ "2st quartile",
log10.hra>4.59 & log10.hra<=6.03 ~ "3st quartile",
log10.hra>6.03 ~ "4st quartile")) %>%
filter(hra_category == "2st quartile") %>%
ggplot(aes(x=class, y=log10.mass, fill=class))+
geom_boxplot()
homerange %>%
mutate(hra_category= case_when(log10.hra<3.65 ~ "1st quartile",
log10.hra>3.65 & log10.hra<=4.59 ~ "2st quartile",
log10.hra>4.59 & log10.hra<=6.03 ~ "3st quartile",
log10.hra>6.03 ~ "4st quartile")) %>%
filter(hra_category == "3st quartile") %>%
ggplot(aes(x=class, y=log10.mass, fill=class))+
geom_boxplot()
homerange %>%
mutate(hra_category= case_when(log10.hra<3.65 ~ "1st quartile",
log10.hra>3.65 & log10.hra<=4.59 ~ "2st quartile",
log10.hra>4.59 & log10.hra<=6.03 ~ "3st quartile",
log10.hra>6.03 ~ "4st quartile")) %>%
filter(hra_category == "2st quartile") %>%
ggplot(aes(x=class, y=log10.mass, fill=class))+
geom_boxplot()

knitr::opts_chunk$set(echo = TRUE)
surgery <- read_csv("data/surgery.csv")
library("tidyverse")
library("janitor")
library("naniar")
surgery <- read_csv("data/surgery.csv")
summary(surgery)
surgery <- surgery %>%
mutate(across(everything(), ~ ifelse(.x %in% c(-999.00, ".", " ", "not measured", "NA", "\\"), NA, .x)))
names(surgery)
surgery %>%
count(race, count = T) %>%
ggplot(aes(x=race, y=n))+
geom_col()+
coord_flip()
surgery %>%
ggplot(aes(x=race, fill=race))+
geom_bar(alpha=0.6, color="black")+
labs(title="Participants by Race",
x=NULL,
y="# participants")+
theme_light()
surgery %>%
count(race, count = T, fill=race) %>%
ggplot(aes(x=race, y=n))+
geom_col()+
coord_flip()
surgery %>%
count(race, count = T, fill=race) %>%
ggplot(aes(x=race, y=n))+
geom_col()+
coord_flip() +
labs(title="Participants by Race",
x=NULL,
y="# participants")+
theme_light()
surgery %>%
count(race, count = T, fill=race) %>%
ggplot(aes(x=race, y=n))+
geom_col()+
labs(title="Participants by Race",
x=NULL,
y="# participants")+
theme_light()
surgery %>%
count(race, count = T) %>%
ggplot(aes(x=race, y=n, , fill=race))+
geom_col()+
labs(title="Participants by Race",
x=NULL,
y="# participants")+
theme_light()
surgery %>%
count(race, count = T) %>%
ggplot(aes(x=race, y=n, fill=race))+
geom_col(alpha=0.6, color="black")+
labs(title="Participants by Race",
x=NULL,
y="# participants")+
theme_light()
surgery %>%
group_by(gender) %>%
summarise(mean_age = mean(age, na.rm=T)) %>%
ggplot(aes(x=reorder(gender, mean_age), y=mean_age))+
geom_col()+
coord_flip()+
scale_y_log10()
surgery %>%
filter(gender!="NA") %>%
group_by(gender) %>%
summarise(mean_age = mean(age, na.rm=T)) %>%
ggplot(aes(x=reorder(gender, mean_age), y=mean_age))+
geom_col()+
coord_flip()+
scale_y_log10()
surgery %>%
filter(gender!="NA") %>%
group_by(gender) %>%
summarise(mean_age = mean(age, na.rm=T)) %>%
ggplot(aes(x=reorder(gender, mean_age), y=mean_age, fill=gender))+
geom_col()+
coord_flip()+
scale_y_log10()
surgery %>%
filter(gender!="NA") %>%
group_by(gender) %>%
summarise(mean_age = mean(age, na.rm=T)) %>%
ggplot(aes(x=reorder(gender, mean_age), y=mean_age, fill=gender))+
geom_col()+
coord_flip()
surgery %>%
filter(gender!="NA") %>%
group_by(gender) %>%
summarise(mean_age = mean(age, na.rm=T)) %>%
ggplot(aes(x=reorder(gender, mean_age), y=mean_age, fill=gender))+
geom_col()+
coord_flip()+
labs(title="Range of Participants' Age by Gender",
x=NULL,
y="Age (years)")+
theme_light()
surgery %>%
filter(gender!="NA") %>%
group_by(gender) %>%
summarise(mean_age = mean(age, na.rm=T))
surgery %>%
filter(gender!="NA") %>%
group_by(gender) %>%
summarise(mean_age = mean(age, na.rm=T)) %>%
ggplot(aes(x=reorder(gender, mean_age), y=mean_age, fill=gender))+
geom_col()+
coord_flip()+
labs(title="Range of Participants' Age by Gender",
x=NULL,
y="Age (years)")+
theme_light()
surgery %>%
filter(asa_status!="NA") %>%
ggplot(aes(x=asa_status, fill=asa_status))+
geom_bar(color="pink", alpha=0.6)+
labs(title="ASA Status of Participants", x="ASA", y="# Participants")+
theme_light()
surgery %>%
filter(asa_status!="NA") %>%
ggplot(aes(x=asa_status, fill=asa_status))+
geom_bar(color="black", alpha=0.6)+
labs(title="ASA Status of Participants", x="ASA", y="# Participants")+
theme_light()
surgery %>%
ggplot(aes(x=bmi))+
geom_density(fill="pink", color="black", alpha=0.6, na.rm=T)+
facet_wrap(~asa_status)+
labs(title="Distribution of BMI", x="BMI", y=NULL)+
theme_light()
surgery %>%
filter(asa_status!="NA") %>%
ggplot(aes(x=bmi))+
geom_density(fill="pink", color="black", alpha=0.6, na.rm=T)+
facet_wrap(~asa_status)+
labs(title="Distribution of BMI", x="BMI", y=NULL)+
theme_light()
surgery %>%
group_by(ahrq_ccs) %>%
summarise(ccsmort30rate=mean(ccsmort30rate)) %>%
arrange(desc(ccsmort30rate)) %>%
slice_max(ccsmort30rate, n=5))
surgery %>%
group_by(ahrq_ccs) %>%
summarise(ccsmort30rate=mean(ccsmort30rate)) %>%
arrange(desc(ccsmort30rate)) %>%
head(5)
surgery %>%
group_by(ahrq_ccs) %>%
summarise(ccscomplicationrate=mean(ccscomplicationrate)) %>%
arrange(desc(ccscomplicationrate)) %>%
slice_max(ccscomplicationrate, n=5)
surgery %>%
select(ahrq_ccs, ccsmort30rate, ccscomplicationrate)
filter(ahrq_ccs %in% c("Colorectal resection", "Small bowel resection", "Gastrectomy; partial and total", "Endoscopy and endoscopic biopsy of the urinary tract", "Spinal fusion", "Nephrectomy; partial or complete")) %>%
group_by(ahrq_ccs) %>%
summarise(ccsmort30rate=mean(ccsmort30rate),
ccscomplicationrate=mean(ccscomplicationrate))
surgery %>%
select(ahrq_ccs, ccsmort30rate, ccscomplicationrate) %>%
filter(ahrq_ccs %in% c("Colorectal resection", "Small bowel resection", "Gastrectomy; partial and total", "Endoscopy and endoscopic biopsy of the urinary tract", "Spinal fusion", "Nephrectomy; partial or complete")) %>%
group_by(ahrq_ccs) %>%
summarise(ccsmort30rate=mean(ccsmort30rate),
ccscomplicationrate=mean(ccscomplicationrate))
surgery %>%
select(ahrq_ccs, ccsmort30rate) %>%
group_by(ahrq_ccs) %>%
ggplot(aes(x=ahrq_ccs, y=ccsmort30rate))+
geom_col(position="dodge", fill="pink", alpha=0.6)+
coord_flip()+
labs(title="30-Day Mortality by Procedure",
x=NULL,
y="Rate")+
theme_light()
View(surgery)
surgery %>%
group_by(month) %>%
mutate(mort30_n = ifelse(mort30 == "Yes", 1, 0),
complication_n = ifelse(complication =="Yes", 1, 0)) %>%
summarise(n_deaths=sum(mort30_n),
n_comp=sum(complication_n))
surgery_new
surgery_new <- surgery %>%
group_by(month) %>%
mutate(mort30_n = ifelse(mort30 == "Yes", 1, 0),
complication_n = ifelse(complication =="Yes", 1, 0)) %>%
summarise(n_deaths=sum(mort30_n),
n_comp=sum(complication_n))
surgery_new
surgery_new <- surgery %>%
group_by(month) %>%
mutate(mort30_n = ifelse(mort30 == "Yes"),
complication_n = ifelse(complication =="Yes")) %>%
summarise(n_deaths=sum(mort30_n),
n_comp=sum(complication_n))
surgery_new <- surgery %>%
group_by(month) %>%
mutate(mort30_n = ifelse(mort30 == "Yes"),
complication_n = ifelse(complication =="Yes", 1, 0)) %>%
summarise(n_deaths=sum(mort30_n),
n_comp=sum(complication_n))
surgery_new <- surgery %>%
group_by(month) %>%
mutate(mort30_n = ifelse(mort30 == "Yes", 1, 0),
complication_n = ifelse(complication =="Yes", 1, 0)) %>%
summarise(n_deaths=sum(mort30_n),
n_comp=sum(complication_n))
surgery_new
surgery %>% tabyl(month, mort30)
surgery_new <- surgery %>%
group_by(month) %>%
mutate(mort30_n = ifelse(mort30 == "Yes", 1, 0),
complication_n = ifelse(complication =="Yes", 1, 0)) %>%
summarise(n_deaths=sum(mort30_n),
n_comp=sum(complication_n)) %>%
arrange(desc(mort30_n))
surgery_new <- surgery %>%
group_by(month) %>%
mutate(mort30_n = ifelse(mort30 == "Yes", 1, 0),
complication_n = ifelse(complication =="Yes", 1, 0)) %>%
summarise(n_deaths=sum(mort30_n),
n_comp=sum(complication_n)) %>%
arrange(desc(n_deaths))
surgery_new
surgery_new %>%
ggplot(aes(x=month, y=n_deaths))+
geom_col(alpha=0.8, fill="steelblue", color="black")+
labs(title="30-Day Mortality by Month",
x=NULL,
y="Rate")+
scale_x_discrete(limits=c("Jan","Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))+
theme_light()
surgery_new %>%
ggplot(aes(x=month, y=n_deaths))+
geom_col(alpha=0.8, fill="n_comp", color="black")+
labs(title="30-Day Mortality by Month",
x=NULL,
y="Rate")+
scale_x_discrete(limits=c("Jan","Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))+
theme_light()
surgery_new %>%
ggplot(aes(x=month, y=n_deaths))+
geom_col(alpha=0.8, fill=n_comp, color="black")+
labs(title="30-Day Mortality by Month",
x=NULL,
y="Rate")+
scale_x_discrete(limits=c("Jan","Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))+
theme_light()
surgery_new %>%
ggplot(aes(x=month, y=n_deaths, fill=n_comp))+
geom_col(alpha=0.8, fill="steelblue", color="black")+
labs(title="30-Day Mortality by Month",
x=NULL,
y="Rate")+
scale_x_discrete(limits=c("Jan","Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))+
theme_light()
surgery_new %>%
ggplot(aes(x=month, y=n_deaths, fill=n_comp))+
geom_col(alpha=0.8, color="black")+
labs(title="30-Day Mortality by Month",
x=NULL,
y="Rate")+
scale_x_discrete(limits=c("Jan","Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))+
theme_light()
surgery_new %>%
ggplot(aes(x=month, y=n_deaths, fill=n_comp))+
geom_col(alpha=0.8, color="black")+
labs(title="30-Day Mortality by Month",
x=NULL,
y="Rate")+
scale_x_discrete(limits=c("Jan","Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))+
theme(legend.position = "top",
axis.text.x = element_text(angle = 60, hjust=0))+
theme_light()
surgery_new %>%
ggplot(aes(x=month, y=n_deaths, fill=n_comp))+
geom_col(alpha=0.8, color="black")+
labs(title="30-Day Mortality by Month",
x=NULL,
y="Rate")+
scale_x_discrete(limits=c("Jan","Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 60, hjust=0))+
theme_light()
surgery_new %>%
ggplot(aes(x=month, y=n_deaths, fill=n_comp))+
geom_col(alpha=0.8, color="black")+
labs(title="30-Day Mortality by Month",
x=NULL,
y="Rate")+
scale_x_discrete(limits=c("Jan","Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 60, hjust=0))
surgery_new %>%
ggplot(aes(x=month, y=n_deaths, fill=n_comp))+
geom_col(alpha=0.8, color="black")+
theme_economist()+
labs(title="30-Day Mortality by Month",
x=NULL,
y="Rate")+
scale_x_discrete(limits=c("Jan","Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 60, hjust=0))
surgery_new %>%
ggplot(aes(x=month, y=n_deaths, fill=n_comp))+
geom_col(alpha=0.8, color="black")+
labs(title="30-Day Mortality by Month",
x=NULL,
y="Rate")+
scale_x_discrete(limits=c("Jan","Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 60, hjust=0))+
theme_light()
surgery_new %>%
ggplot(aes(x=month, y=n_deaths, fill=n_comp))+
geom_col(alpha=0.8, color="black")+
labs(title="30-Day Mortality by Month",
x=NULL,
y="Rate")+
scale_x_discrete(limits=c("Jan","Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))+
theme_light()
